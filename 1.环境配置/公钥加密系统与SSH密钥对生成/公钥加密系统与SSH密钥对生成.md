SSH密钥是一种用于安全远程登录的身份验证方式。它由一对私钥（公钥和私钥）组成，用于验证用户身份并加密通信。SSH密钥广泛应用于以下领域：

-  远程服务器登录

    在服务器上配置公钥，用户可以使用私钥进行身份验证，从而安全地登录远程服务器，而无需输入密码。

- 版本控制系统

    许多版本控制系统（如GitHub）支持使用SSH密钥进行身份验证。通过在代码仓库中添加公钥，可以实现无需密码的安全代码推送和拉取。

- 云平台管理

    通过将公钥添加到云平台的实例配置中，可以安全地访问以及管理云服务器。

为了了解SSH密钥的运行原理，我们简单介绍一下公钥加密系统。



#### 公钥加密系统

通过公钥加密系统，公私钥机制可以对传输于两个通信单位之间的消息进行加密，即使窃听者窃听到被加密的消息，也不能对其进行破译。公钥加密系统还能让通信的一方，在电子消息的末尾附加一个无法伪造的“数字签名”。这种签名是纸质文件上的手写签名的电子版本。任何人都可以轻松地核对签名，但却不能伪造它，如果这一消息中的任何位有所变化，整个签名就失去了效力，因此，数字签名可以为签名者身份和其签署的信息内容提供证明。

在一个公钥加密系统中，每个参与者均自己创建公钥和私钥。私钥需要保密，但公钥则可以对任何人透露，甚至可以公之于众。系统中任何参与者的公钥和私钥都是一个“匹配对”，它们指定的函数互为反函数。即：

M = S~A~(P~A~(M))

M = P~A~(S~A~(M))

> M：msg；S~A~()：A的私钥；P~A~()：A的公钥

在公钥加密系统中，要求除了A外，没人能在较实用的时间内计算出函数S~A~()。

##### 收发消息过程

- B取得A的公钥P~A~（根据一个公开的目录或直接向A索取）。

- B计算出相应于M的密文C＝P~A~(M)，并把C发送给A。
- 当A收到密文C后，她运用自己的密钥S~A~()恢复原始信息。

##### 数字签名过程

###### 公开信息签名签署

- A运用密钥S~A~和等式σ=S~A~(M')计算出信息M'的数字签名σ。
- A把消息／签名对(M', σ)发送给 B。
- 当B收到(M', σ)时，他可以利用A的公钥，通过验证等式M' = P~A~(σ)来证实该消息的确是来自A。（假设M包含A的名字，这样B就知道应该使用谁的公钥。）

因为一个数字签名既证明了签署者身份，也证明了签署的信息内容，所以它是对文件末尾的手写签名的一种模拟。数字签名必须可被任何能取得签署者的公钥的人所验证，一条签署过的信息可以被一方确认后再传送到其他可以验证签名的各方。

###### 非公开信息签名签署

- A把其数字签名附加在消息的后面
- A用B的公钥P~B~()对最终的消息／签名对进行加密
- B用其密钥S~B~()对收到的消息进行解密，以同时获得原始消息和数字签名。
- B可以用A的公钥P~A~()对签名进行验证。



#### ssh-keygen工具生成私钥对

OpenSSH为我们提供了一款实用工具ssh-keygen用于创建私钥对。

##### 常用的参数

- -t 用于指定加密类型

    如果没有指定任何参数，ssh-keygen将生成一个RSA私钥。

- -p 用于指定密码短语

    密码短语是可选的设置项，为私钥设置密码短语可以提高私钥的安全性。以避免任何能够访问私钥的人都可以使用它。

##### 生成密钥对

```shell
ssh-keygen
```

运行ssh-keygen后，程序会询问你密钥保存的位置以及密码短语。生成完毕后有两个文件，其中以.pub后缀命名的是公钥，另一个是私钥。

##### 复制公钥

```shell
cat ${KEY_PATH}/${KEY_NAME}.pub
```

